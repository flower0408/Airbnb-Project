<app-header></app-header>
<div *ngIf="accommodation" class="accommodation-details">
  <h2 class="accommodation-title">{{ accommodation.name }}</h2>
  <p class="accommodation-description">{{ accommodation.description }}</p>

  <div *ngIf="accommodation.location">
    <div class="detail location">
      <span class="detail-label">Location:</span>
      <span class="detail-value">
        {{ accommodation.location.street }},
        {{ accommodation.location.number }},
        {{ accommodation.location.city }},
        {{ accommodation.location.country }}
      </span>
    </div>
  </div>

  <div class="detail benefits">
    <span class="detail-label">Benefits:</span>
    <ul>
      <li *ngFor="let benefit of accommodation.benefits.split(',')">{{ benefit }}</li>
    </ul>
  </div>

  <div class="detail guests">
    <span class="detail-label">Guests:</span>
    <span class="detail-value">
      {{ accommodation.minGuest }} - {{ accommodation.maxGuest }} guests
    </span>
  </div>


  <form *ngIf="userRole === 'Guest'" [formGroup]="reservationForm" (ngSubmit)="onSubmit()">
    <label>Start day</label>
    <mat-form-field appearance="outline">
    <input matInput formControlName="startDay"
           [matDatepickerFilter]="dateFilter"
           [matDatepicker]="releasedAtPicker1">
    <mat-datepicker-toggle matSuffix [for]="releasedAtPicker1"></mat-datepicker-toggle>
    <mat-datepicker #releasedAtPicker1></mat-datepicker>
    </mat-form-field>

    <label>End day</label>
    <mat-form-field appearance="outline">
      <input matInput formControlName="endDay"
             [matDatepickerFilter]="dateFilter"
             [matDatepicker]="releasedAtPicker2">
      <mat-datepicker-toggle matSuffix [for]="releasedAtPicker2"></mat-datepicker-toggle>
      <mat-datepicker #releasedAtPicker2></mat-datepicker>
    </mat-form-field>

    <div *ngFor="let row of counterRows" class="container">
      <p>{{ row }}</p>
    </div>
    <div style="border-bottom: 1px solid gray;" class="container" *ngIf="reservationForm.get('startDay')?.value !== '' && reservationForm.get('endDay')?.value !== ''">
      <h2 *ngFor="let detail of priceDetails" style="color: rgb(67, 67, 67); ">Total price: {{ detail.numberOfDays }}x{{ detail.price }}€ = {{ detail.numberOfDays * detail.price }}€</h2>
    </div>

    <div class="container" style="padding-top: 25px;">
      <button type="submit" class="formbold-btn">Create reservation</button>
    </div>

  </form>
</div>

<div class="container" *ngIf="userRole === 'Host' && hostId === accommodation?.ownerId">
  <button type="button" (click)="moreOptions()" class="btn btn-outline-primary">More options</button>
</div>

<div *ngIf="showMoreOption && userRole === 'Host'" class="accommodation-details">

  <form [formGroup]="addAppointmentForm" (ngSubmit)="onSubmitAddAppointment()">
    <h2 style="text-align: center;color: blue;">Add appointment</h2>
    <label>Start day</label>
    <mat-form-field appearance="outline">
    <input matInput formControlName="startDay"
           [matDatepickerFilter]="dateFilter2"
           [matDatepicker]="releasedAtPicker3">
    <mat-datepicker-toggle matSuffix [for]="releasedAtPicker3"></mat-datepicker-toggle>
    <mat-datepicker #releasedAtPicker3></mat-datepicker>
    </mat-form-field>

    <label>End day</label>
    <mat-form-field appearance="outline">
      <input matInput formControlName="endDay"
             [matDatepickerFilter]="dateFilter2"
             [matDatepicker]="releasedAtPicker4">
      <mat-datepicker-toggle matSuffix [for]="releasedAtPicker4"></mat-datepicker-toggle>
      <mat-datepicker #releasedAtPicker4></mat-datepicker>
    </mat-form-field>

    <div class="formbold-mb-5" *ngIf="inputGuestPrice">
      <input
        type="number"
        class="formbold-form-input"
        formControlName="guestPrice"
        placeholder="Guest price"
        id="guestPrice"
        name="guestPrice"
      />

    </div>
    <div class="formbold-mb-5" *ngIf="inputAccommodationPrice">
      <input
        type="number"
        class="formbold-form-input"
        formControlName="accommodationPrice"
        placeholder="Accommodation price"
        id="accommodationPrice"
        name="accommodationPrice"
      />

    </div>

    <div class="container">
      <button type="submit" class="btn btn-primary">Create appointment</button>
    </div>

  </form>

</div>

<div *ngIf="showMoreOption && userRole === 'Host'" class="accommodation-details">

  <form [formGroup]="editAppointmentForm" (ngSubmit)="onSubmitEditAppointment()">
    <h2 style="text-align: center;color: red;">Edit appointment</h2>

    <select class="form-select" aria-label="Default select example" formControlName="selectedAppointment" (change)="onSelectedAppointmentChange($event)">
      <option *ngFor="let ap of appointments; let i = index" [ngValue]="i">
        {{ ap.available[0] | date:'mediumDate':'UTC' }} - {{ ap.available[ap.available.length - 1] | date:'mediumDate':'UTC' }}
      </option>
    </select>



    <label>New start day</label>
    <mat-form-field appearance="outline">
    <input matInput formControlName="startDayEdit"
           [matDatepickerFilter]="dateFilter3"
           [matDatepicker]="releasedAtPicker5">
    <mat-datepicker-toggle matSuffix [for]="releasedAtPicker5"></mat-datepicker-toggle>
    <mat-datepicker #releasedAtPicker5></mat-datepicker>
    </mat-form-field>

    <label>New end day</label>
    <mat-form-field appearance="outline">
      <input matInput formControlName="endDayEdit"
             [matDatepickerFilter]="dateFilter3"
             [matDatepicker]="releasedAtPicker6">
      <mat-datepicker-toggle matSuffix [for]="releasedAtPicker6"></mat-datepicker-toggle>
      <mat-datepicker #releasedAtPicker6></mat-datepicker>
    </mat-form-field>

    <div class="formbold-mb-5" *ngIf="inputGuestPrice">
      <input
        type="number"
        class="formbold-form-input"
        formControlName="guestPriceEdit"
        placeholder="Guest price"
        id="guestPriceEdit"
        name="guestPriceEdit"
      />

    </div>
    <div class="formbold-mb-5" *ngIf="inputAccommodationPrice">
      <input
        type="number"
        class="formbold-form-input"
        formControlName="accommodationPriceEdit"
        placeholder="Accommodation price"
        id="accommodationPriceEdit"
        name="accommodationPriceEdit"
      />

    </div>

    <div class="container">
      <button type="submit" class="btn btn-danger">Edit appointment</button>
    </div>

  </form>

</div>



